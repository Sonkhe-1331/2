{"ast":null,"code":"import _classCallCheck from \"C:/Users/sonkh/2/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/sonkh/2/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport { formatDate } from '@angular/common';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { MatSelect } from '@angular/material/select';\nimport { AuthService } from 'app/auth/auth.service';\nimport { RoomService } from 'app/services/room.service';\nimport { BehaviorSubject, ReplaySubject, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport Swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"app/services/room.service\";\nimport * as i2 from \"app/auth/auth.service\";\nimport * as i3 from \"@angular/material/card\";\nimport * as i4 from \"@angular/material/icon\";\nimport * as i5 from \"@angular/material/form-field\";\nimport * as i6 from \"@angular/material/select\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"@angular/material/core\";\nimport * as i9 from \"@angular/material/datepicker\";\nimport * as i10 from \"@angular/forms\";\nimport * as i11 from \"@angular/material/button\";\nimport * as i12 from \"ngx-mat-select-search\";\nimport * as i13 from \"@angular/material/progress-spinner\";\nimport * as i14 from \"@angular/material/chips\";\nvar _c0 = [\"multiSelect\"];\n\nfunction BookingComponent_mat_option_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var item_r7 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", item_r7.Id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", item_r7.name, \" \");\n  }\n}\n\nfunction BookingComponent_mat_option_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var amenity_r8 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", amenity_r8);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", amenity_r8.Name, \" \");\n  }\n}\n\nfunction BookingComponent_mat_spinner_54_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-spinner\");\n  }\n}\n\nfunction BookingComponent_ng_template_56_ng_container_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 30)(2, \"h3\");\n    i0.ɵɵtext(3, \"No rooms available for the selected days.\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n}\n\nfunction BookingComponent_ng_template_56_div_1_ul_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\")(1, \"li\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    var amenity_r14 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(amenity_r14);\n  }\n}\n\nfunction BookingComponent_ng_template_56_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r16 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 30)(1, \"div\", 31)(2, \"h4\", 32);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 33)(5, \"i\", 34);\n    i0.ɵɵtext(6, \"warning\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"a\", 35);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(9, \"div\", 36)(10, \"div\", 20)(11, \"mat-chip\", 37);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"h5\", 32);\n    i0.ɵɵtext(14, \"Amenities \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(15, BookingComponent_ng_template_56_div_1_ul_15_Template, 3, 1, \"ul\", 38);\n    i0.ɵɵelementStart(16, \"div\", 20)(17, \"button\", 39);\n    i0.ɵɵlistener(\"click\", function BookingComponent_ng_template_56_div_1_Template_button_click_17_listener() {\n      var restoredCtx = i0.ɵɵrestoreView(_r16);\n      var room_r12 = restoredCtx.$implicit;\n      var ctx_r15 = i0.ɵɵnextContext(2);\n      return ctx_r15.Book(room_r12.id);\n    });\n    i0.ɵɵtext(18, \"Book Room\");\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    var room_r12 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(room_r12.roomName);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"\", room_r12.numberOfAvailableRooms, \" Rooms Available\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"R\", room_r12.rate, \" Per Day\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", room_r12.Amenities);\n  }\n}\n\nfunction BookingComponent_ng_template_56_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, BookingComponent_ng_template_56_ng_container_0_Template, 4, 0, \"ng-container\", 28);\n    i0.ɵɵtemplate(1, BookingComponent_ng_template_56_div_1_Template, 19, 4, \"div\", 29);\n  }\n\n  if (rf & 2) {\n    var ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngIf\", ctx_r6.roomsAvailable.length == 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r6.roomsAvailable);\n  }\n}\n\nexport var BookingComponent = /*#__PURE__*/function () {\n  function BookingComponent(roomService, auth) {\n    _classCallCheck(this, BookingComponent);\n\n    this.roomService = roomService;\n    this.auth = auth;\n    this.roomTypes = [];\n    this.amenities = [];\n    this.selectedAmenities = [];\n    this.roomsAvailable = [];\n    this.range = new FormGroup({\n      start: new FormControl(''),\n      end: new FormControl('')\n    });\n    /** control for the selected bank for multi-selection */\n\n    this.amenitiesMultiCtrl = new FormControl();\n    /** control for the MatSelect filter keyword multi-selection */\n\n    this.amenitiesMultiFilterCtrl = new FormControl();\n    /** list of banks filtered by search keyword */\n\n    this.filteredMulti = new ReplaySubject(1);\n    this.$loader = new BehaviorSubject(false);\n    /** Subject that emits when the component has been destroyed. */\n\n    this._onDestroy = new Subject();\n  }\n\n  _createClass(BookingComponent, [{\n    key: \"ngOnInit\",\n    value: function ngOnInit() {\n      var _this = this;\n\n      this.getAmenities();\n      this.getRoomsTypes();\n      this.amenitiesMultiFilterCtrl.valueChanges.pipe(takeUntil(this._onDestroy)).subscribe(function () {\n        _this.filterMulti();\n      });\n    }\n  }, {\n    key: \"onSelect\",\n    value: function onSelect(evt) {\n      this.roomTypeId = evt.value || null;\n    }\n  }, {\n    key: \"checkRoomAvailability\",\n    value: function checkRoomAvailability(range, amenities) {\n      var _this2 = this;\n\n      var dataRange = this.range.value;\n\n      if (this.roomTypeId != null && dataRange.start != null && dataRange.end != null) {\n        {\n          var newRanger = {\n            startDate: formatDate(new Date(dataRange.start), 'yyyy/MM/dd hh:mm:ss', 'en_US'),\n            endDate: formatDate(new Date(dataRange.end), 'yyyy/MM/dd hh:mm:ss', 'en_US')\n          };\n          amenities = amenities.map(function (amenity) {\n            return amenity.Id;\n          });\n          this.$loader.next(true);\n          this.roomService.checkRoomAvailability(this.roomTypeId, newRanger, amenities).subscribe(function (res) {\n            if (res) {\n              _this2.roomsAvailable = res;\n\n              _this2.$loader.next(false);\n            }\n          });\n        }\n      }\n    }\n  }, {\n    key: \"Book\",\n    value: function Book(roomId) {\n      var _this3 = this;\n\n      var dataRange = this.range.value;\n      var newRanger = {\n        startDate: formatDate(new Date(dataRange.start), 'yyyy/MM/dd hh:mm:ss', 'en_US'),\n        endDate: formatDate(new Date(dataRange.end), 'yyyy/MM/dd hh:mm:ss', 'en_US')\n      };\n      var book = Object.assign({\n        roomId: roomId,\n        userId: this.auth.getUserID\n      }, newRanger);\n      Swal.fire({\n        title: 'Are you sure you want to book for',\n        text: \"\".concat(newRanger.startDate, \" - \").concat(newRanger.endDate),\n        icon: 'warning',\n        showCancelButton: true,\n        confirmButtonColor: '#ff0000',\n        cancelButtonColor: '#d33',\n        confirmButtonText: 'Yes, book it!'\n      }).then(function (result) {\n        if (result.isConfirmed) {\n          _this3.roomService.bookRoom(book).subscribe(function (result) {\n            Swal.fire('Booked!', 'Room successfully booked.', 'success');\n          }, function (error) {});\n        }\n      });\n    } //function to get roomTypes\n\n  }, {\n    key: \"getRoomsTypes\",\n    value: function getRoomsTypes() {\n      var _this4 = this;\n\n      this.roomService.getRoomsTypes().subscribe(function (res) {\n        _this4.roomTypes = res;\n      });\n    } //function to get roomTypes\n\n  }, {\n    key: \"getAmenities\",\n    value: function getAmenities() {\n      var _this5 = this;\n\n      this.roomService.getAmenities().subscribe(function (res) {\n        _this5.filteredMulti.next(res);\n\n        _this5.amenities = res;\n      });\n    }\n  }, {\n    key: \"ngOnDestroy\",\n    value: function ngOnDestroy() {\n      this._onDestroy.next();\n\n      this._onDestroy.complete();\n    }\n  }, {\n    key: \"filterMulti\",\n    value: function filterMulti() {\n      if (!this.amenities) {\n        return;\n      } // get the search keyword\n\n\n      var search = this.amenitiesMultiFilterCtrl.value;\n\n      if (!search) {\n        this.filteredMulti.next(this.amenities.slice());\n        return;\n      } else {\n        search = search.toLowerCase();\n      } // filter the banks\n\n\n      this.filteredMulti.next(this.amenities.filter(function (bank) {\n        return bank.Name.toLowerCase().indexOf(search) > -1;\n      }));\n    }\n  }]);\n\n  return BookingComponent;\n}();\n\nBookingComponent.ɵfac = function BookingComponent_Factory(t) {\n  return new (t || BookingComponent)(i0.ɵɵdirectiveInject(i1.RoomService), i0.ɵɵdirectiveInject(i2.AuthService));\n};\n\nBookingComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: BookingComponent,\n  selectors: [[\"app-booking\"]],\n  viewQuery: function BookingComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n\n    if (rf & 2) {\n      var _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.multiSelect = _t.first);\n    }\n  },\n  decls: 58,\n  vars: 14,\n  consts: [[1, \"main-content\"], [1, \"container-fluid\"], [1, \"example-card\"], [\"mat-card-avatar\", \"\"], [1, \"row\"], [1, \"col\"], [1, \"m-2\"], [3, \"selectionChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"appearance\", \"fill\", 1, \"example-form-field\"], [3, \"rangePicker\", \"formGroup\"], [\"matStartDate\", \"\", \"formControlName\", \"start\", \"placeholder\", \"Start date\"], [\"matEndDate\", \"\", \"formControlName\", \"end\", \"placeholder\", \"End date\"], [\"matSuffix\", \"\", 3, \"for\"], [\"rangePicker\", \"\"], [\"mat-button\", \"\", \"matDateRangePickerCancel\", \"\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"matDateRangePickerApply\", \"\"], [\"placeholder\", \"Banks\", 3, \"formControl\", \"multiple\"], [\"multiSelect\", \"\"], [3, \"formControl\"], [1, \"d-grid\", \"gap-2\", \"d-md-flex\", \"justify-content-md-end\"], [\"mat-stroked-button\", \"\"], [\"mat-raised-button\", \"\", \"color\", \"warn\", 3, \"click\"], [1, \"col-md-12\"], [1, \"justify-content-between\"], [4, \"ngIf\", \"ngIfElse\"], [\"cards\", \"\"], [3, \"value\"], [4, \"ngIf\"], [\"class\", \"card\", 4, \"ngFor\", \"ngForOf\"], [1, \"card\"], [1, \"card-header\", \"card-header-primary\"], [1, \"card-title\"], [1, \"card-category\"], [1, \"material-icons\", \"text-danger\"], [\"href\", \"#pablo\"], [1, \"card-body\"], [\"color\", \"primary\", \"selected\", \"\", 2, \"font-size\", \"16px\", \"font-weight\", \"bold\"], [4, \"ngFor\", \"ngForOf\"], [\"mat-raised-button\", \"\", \"color\", \"danger\", 1, \"btn\", \"orange\", 3, \"click\"]],\n  template: function BookingComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"mat-card\", 2)(3, \"mat-card-header\")(4, \"mat-icon\", 3);\n      i0.ɵɵtext(5, \"house\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"mat-card-title\");\n      i0.ɵɵtext(7, \"Check Rooms Available\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"mat-card-subtitle\");\n      i0.ɵɵtext(9, \"Select the parameters to filter the learners\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(10, \"mat-card-content\")(11, \"div\", 4)(12, \"div\", 5)(13, \"div\")(14, \"mat-form-field\", 6)(15, \"mat-label\");\n      i0.ɵɵtext(16, \"Choose Room Type\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(17, \"mat-select\", 7);\n      i0.ɵɵlistener(\"selectionChange\", function BookingComponent_Template_mat_select_selectionChange_17_listener($event) {\n        return ctx.onSelect($event);\n      });\n      i0.ɵɵtemplate(18, BookingComponent_mat_option_18_Template, 2, 2, \"mat-option\", 8);\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(19, \"div\", 5)(20, \"mat-form-field\", 9)(21, \"mat-label\");\n      i0.ɵɵtext(22, \"Enter a date range\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(23, \"mat-date-range-input\", 10);\n      i0.ɵɵelement(24, \"input\", 11)(25, \"input\", 12);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(26, \"mat-hint\");\n      i0.ɵɵtext(27, \"MM/DD/YYYY \\u2013 MM/DD/YYYY\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(28, \"mat-datepicker-toggle\", 13);\n      i0.ɵɵelementStart(29, \"mat-date-range-picker\", null, 14)(31, \"mat-date-range-picker-actions\")(32, \"button\", 15);\n      i0.ɵɵtext(33, \"Cancel\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(34, \"button\", 16);\n      i0.ɵɵtext(35, \"Apply\");\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(36, \"div\", 5)(37, \"mat-form-field\", 9)(38, \"mat-select\", 17, 18)(40, \"mat-option\");\n      i0.ɵɵelement(41, \"ngx-mat-select-search\", 19);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(42, BookingComponent_mat_option_42_Template, 2, 2, \"mat-option\", 8);\n      i0.ɵɵpipe(43, \"async\");\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(44, \"mat-card-actions\")(45, \"div\", 20)(46, \"button\", 21);\n      i0.ɵɵtext(47, \"Cancel\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(48, \"button\", 22);\n      i0.ɵɵlistener(\"click\", function BookingComponent_Template_button_click_48_listener() {\n        return ctx.checkRoomAvailability(ctx.range.value, ctx.amenitiesMultiCtrl == null ? null : ctx.amenitiesMultiCtrl.value);\n      });\n      i0.ɵɵtext(49, \"View Available Rooms<\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(50, \"div\")(51, \"div\", 4)(52, \"div\", 23)(53, \"div\", 24);\n      i0.ɵɵtemplate(54, BookingComponent_mat_spinner_54_Template, 1, 0, \"mat-spinner\", 25);\n      i0.ɵɵpipe(55, \"async\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(56, BookingComponent_ng_template_56_Template, 2, 2, \"ng-template\", null, 26, i0.ɵɵtemplateRefExtractor);\n      i0.ɵɵelementEnd()()()()();\n    }\n\n    if (rf & 2) {\n      var _r1 = i0.ɵɵreference(30);\n\n      var _r5 = i0.ɵɵreference(57);\n\n      i0.ɵɵadvance(18);\n      i0.ɵɵproperty(\"ngForOf\", ctx.roomTypes);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"rangePicker\", _r1)(\"formGroup\", ctx.range);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"for\", _r1);\n      i0.ɵɵadvance(10);\n      i0.ɵɵproperty(\"formControl\", ctx.amenitiesMultiCtrl)(\"multiple\", true);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"formControl\", ctx.amenitiesMultiFilterCtrl);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(43, 10, ctx.filteredMulti));\n      i0.ɵɵadvance(12);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(55, 12, ctx.$loader))(\"ngIfElse\", _r5);\n    }\n  },\n  directives: [i3.MatCard, i3.MatCardHeader, i4.MatIcon, i3.MatCardAvatar, i3.MatCardTitle, i3.MatCardSubtitle, i3.MatCardContent, i5.MatFormField, i5.MatLabel, i6.MatSelect, i7.NgForOf, i8.MatOption, i9.MatDateRangeInput, i10.NgControlStatusGroup, i10.FormGroupDirective, i9.MatStartDate, i10.DefaultValueAccessor, i10.NgControlStatus, i10.FormControlName, i9.MatEndDate, i5.MatHint, i9.MatDatepickerToggle, i5.MatSuffix, i9.MatDateRangePicker, i9.MatDatepickerActions, i11.MatButton, i9.MatDatepickerCancel, i9.MatDatepickerApply, i10.FormControlDirective, i12.MatSelectSearchComponent, i3.MatCardActions, i7.NgIf, i13.MatSpinner, i14.MatChip],\n  pipes: [i7.AsyncPipe],\n  styles: [\"p[_ngcontent-%COMP%] {\\n  font-family: Lato;\\n}\\n\\n.btn[_ngcontent-%COMP%] {\\n  position: relative;\\n  display: block;\\n  margin: 30px auto;\\n  padding: 0;\\n  overflow: hidden;\\n  border-width: 0;\\n  outline: none;\\n  border-radius: 2px;\\n  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.6);\\n  background-color: #2ecc71;\\n  color: #ecf0f1;\\n  transition: background-color 0.3s;\\n}\\n\\n.btn[_ngcontent-%COMP%]:hover, .btn[_ngcontent-%COMP%]:focus {\\n  background-color: #27ae60;\\n}\\n\\n.btn[_ngcontent-%COMP%]    > *[_ngcontent-%COMP%] {\\n  position: relative;\\n}\\n\\n.btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\\n  display: block;\\n  padding: 12px 24px;\\n}\\n\\n.btn[_ngcontent-%COMP%]:before {\\n  content: \\\"\\\";\\n  position: absolute;\\n  top: 50%;\\n  left: 50%;\\n  display: block;\\n  width: 0;\\n  padding-top: 0;\\n  border-radius: 100%;\\n  background-color: rgba(236, 240, 241, 0.3);\\n  transform: translate(-50%, -50%);\\n}\\n\\n.btn[_ngcontent-%COMP%]:active:before {\\n  width: 120%;\\n  padding-top: 120%;\\n  transition: width 0.2s ease-out, padding-top 0.2s ease-out;\\n}\\n\\n\\n\\n*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after {\\n  box-sizing: border-box;\\n}\\n\\nhtml[_ngcontent-%COMP%] {\\n  position: relative;\\n  height: 100%;\\n}\\n\\nbody[_ngcontent-%COMP%] {\\n  position: absolute;\\n  top: 50%;\\n  left: 50%;\\n  transform: translate(-50%, -50%);\\n  background-color: #ecf0f1;\\n  color: #34495e;\\n  font-family: Trebuchet, Arial, sans-serif;\\n  text-align: center;\\n}\\n\\nh2[_ngcontent-%COMP%] {\\n  font-weight: normal;\\n}\\n\\n.btn.orange[_ngcontent-%COMP%] {\\n  background-color: #e67e22;\\n}\\n\\n.btn.orange[_ngcontent-%COMP%]:hover, .btn.orange[_ngcontent-%COMP%]:focus {\\n  background-color: #d35400;\\n}\\n\\n.btn.red[_ngcontent-%COMP%] {\\n  background-color: #e74c3c;\\n}\\n\\n.btn.red[_ngcontent-%COMP%]:hover, .btn.red[_ngcontent-%COMP%]:focus {\\n  background-color: #c0392b;\\n}\"]\n});","map":null,"metadata":{},"sourceType":"module"}